---
title: 聚类算法之层次聚类
tags:
  - Python
  - 机器学习
  - 聚类算法
abbrlink: aedf7706
categories: 机器学习笔记
date: 2019-10-28 14:37:00
cover: https://gvoidy-1251878576.cos.ap-chengdu.myqcloud.com/%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB1.jpg
---
![层次聚类](https://gvoidy-1251878576.cos.ap-chengdu.myqcloud.com/%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB1.jpg)


层次聚类(Hierarchical Clustering)是聚类算法的一种，通过计算不同类别的相似度类创建一个有层次的嵌套的树。



## 层次聚类怎么算

层次聚类分为**自底向上**和**自顶向下**两种，这里仅采用`scikit-learn`中自底向上层次聚类法。

1. 将数据集中每一个样本都标记为不同类
2. 计算找出其中距离最近的2个类别，合并为一类
3. 依次合并直到最后仅剩下一个列表，即建立起一颗完整的层次树

以下为看图说话~ 感谢 [Laugh's blog](https://www.laugh12321.cn/)借用下说明图

![第一步](https://gvoidy-1251878576.cos.ap-chengdu.myqcloud.com/%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB/2.png)

把所有数据全部分为不同组

![第二步](https://gvoidy-1251878576.cos.ap-chengdu.myqcloud.com/%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB/3.png)

将相邻最近的两组归为同一组

![重复上述操作](https://gvoidy-1251878576.cos.ap-chengdu.myqcloud.com/%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB/4.png)

重复第二步，直到合并成为一个组，聚类结束

![层次树](https://gvoidy-1251878576.cos.ap-chengdu.myqcloud.com/%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB/6.png)

聚类过程的散点图变化一下，就是我们要的层次图

## 层次聚类 Python 实现

```python
import numpy as np
from sklearn.cluster import AgglomerativeClustering
data = np.random.rand(100, 3) #生成一个随机数据，样本大小为100, 特征数为3

#假如我要构造一个聚类数为3的聚类器
estimator = AgglomerativeClustering(n_clusters=3)#构造聚类器
estimator.fit(data)

print(estimator.labels_)#获取聚类标签
```

## 主函数 AgglomerativeClustering 参数解释

```python
AgglomerativeClustering(affinity='euclidean', compute_full_tree='auto',
                        connectivity=None, linkage='ward', 
                        memory=None, n_clusters=2,
                        pooling_func='deprecated')
```

- `affinity`: 亲和力度量，有 euclidean（欧式距离）, l1（L1 范数）, l2（L2 范数）
- `compute_full_tree`: 通常当训练了n_clusters后，训练过程就会停止，但是如果compute_full_tree=True，则会继续训练从而生成一颗完整的树
- `connectivity`: 一个数组或者可调用对象或者None，用于指定连接矩阵
- `linkage`: 连接方法：`ward`（单连接）, `complete`（全连接）, `average`（平均连接）可选
- `memory`: 用于缓存输出的结果，默认为不缓存
- `n_clusters`: 表示最终要查找类别的数量，例如上面的 2 类
- `pooling_func`: 一个可调用对象，它的输入是一组特征的值，输出是一个数

返回值

- `labels`： 每个样本的簇标记
- `n_leaves_`： 分层树的叶节点数量
- `n_components`： 连接图中连通分量的估计值
- `children`： 一个数组，给出了每个非节点数量

