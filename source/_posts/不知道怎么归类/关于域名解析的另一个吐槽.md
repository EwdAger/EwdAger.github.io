---
title: 关于域名解析的另一个吐槽
tags: 吐槽
categories: 不知道怎么归类
abbrlink: bd4cc0f1
date: 2018-02-16 11:02:00
---

今天翻github惊奇的发现，我这个辣鸡博客竟然被[@兴栋大佬](https://github.com/Hiccup1)的博客做了友链。不胜惶恐，但发现友链是之前没填坑的无法访问的裸域名，所以这个坑必须赶紧填啊。之前TX云送的学生cdn+域名解析中@记录和www记录都是设置的CNAME跳转到cdn。。结果访问gvoidy.cn出现404，简直神奇。试过很多次之后还是不行，不知道这是什么鬼。。最后解决方法还是把@记录重定向到https://www.gvoidy.cn 上才解决。有点迷。先留坑以后再研究是什么操作。

** 2.21 21:00 Update **
<s>今天Github发了个邮件过来说我CNAME文件配置的有问题。。结果我一看。woc当时CNAME文件竟然配置的是www.gvoidy.cn。。怪不得访问gvoidy.cn没用。emmm算是完了一个坑吧。。</s>

** 2.21 21:36 Update again **
再次更新。按照上面那个思路设置以后不管gvoidy.cn还是https://www.gvoidy.cn 全都无法访问了。

好吧。确实是域名解析的相关知识不太熟悉导致进了这个坑。因为这个域名下弄了邮箱做了MX记录。MX记录与CNAME记录同时共存会出现一些问题。比如邮件收不到，CNAME又失败等。所以最开始的把gvoidy.cn这个@记录做成重定向的思路是对的。Github那边发邮件是因为我CNAME文件中配置的是www.gvoidy.cn而设置中又是gvoidy.cn所以才会出现错误。但是其实我域名解析那边把gvoidy.cn是重定向到https://www.gvoidy.cn 这个域名的，所以一切正常。

<!--more -->

[知识补充](https://segmentfault.com/a/1190000003495742)：
> 递归DNS服务器在查询某个常规域名记录（非CNAME记录）时，如果在本地cache中已有该域名有对应的CNAME记录，则会开始用该别名记录来重启查询。上文中dig查询MX记录测试示例即对应于这种情况。

> 因此，即使某些域名解析系统网页上并未限制用户同时填写CNAME和MX的操作，但只要将CNAME和MX配置到一起，上述问题也一定是存在的，它会导致邮件服务偶尔出现异常。

> 实际上除了CNAME和MX不能共存外，已经注册了CNAME类型的域名记录是不能再注册除DNSSEC相关类型记录（RRSIG、NSEC等）之外的任何其他类型记录（包括MX、A、NS等记录）。理由同上，这里就不一一做演示了。